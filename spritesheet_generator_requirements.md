# Sprite Sheet Generator 仕様概要

この文書は、現在実装済みのスプライトシートジェネレーター Web アプリに合わせた最新仕様です。

## 1. 概要
- **プロジェクト名**: Sprite Sheet Generator
- **形式**: ブラウザ上で動作する単一ページアプリケーション
- **想定利用者**: ドット絵制作者、ゲーム開発者

## 2. 主要機能

### 2.1 入力
- 入力欄: テキストエリアに JSON 形式の 12×12 数値配列を貼り付け
- 入力データ: 0〜32 の整数を要素に持つ 12 行 × 12 列の二次元配列
- 入力操作: 「追加」ボタンで 1 スプライトを登録、最大 256 個まで
- バリデーション: JSON 解析、行数/列数/数値範囲/整数チェック。最初のエラーのみ表示
- エラーメッセージ表示: 入力欄下部に日本語テキストで表示、次の入力や操作で上書き

### 2.2 スプライト一覧管理
- 表示: チェッカーボード背景のカード形式グリッド
- サムネイル: 12×12 グリッドを 4 倍に拡大したプレビュー（48×48px 相当）
- インデックス: #0, #1 … の番号を左上に表示
- 並び順: 追加順に左から右、上から下
- 削除: 各カードの「削除」ボタンで即時削除、確認ダイアログ無し
- 全削除: 「全削除」ボタンで確認の上、全スプライトを削除
- 現在、ドラッグ＆ドロップによる並べ替えや選択状態のハイライトは **未実装**

### 2.3 レイアウト設定
- 設定項目: 列数（1〜16）、パディング（0〜4px）、マージン（0〜4px）
- プリセット: 標準（8列/0px/0px）、密集（12列/0px/0px）、間隔あり（6列/2px/2px）、カスタム
- プレビュー更新: 設定変更でプレビューに反映
- PNG 出力時: 現状は列数 8、パディング 0、マージン 0 で固定生成（UI 設定は反映されない）

### 2.4 PNG 出力
- 条件: スプライト登録済みで「PNG 出力」ボタンが活性化
- 単体出力: スプライトが 1 枚の場合、単体 PNG を出力。サイズは 12px グリッドを 4 倍に拡大（12×12 → 48×48）
- シート出力: 2 枚以上の場合、列 8 固定・パディング 0・マージン 0 のスプライトシートを出力。各スプライトは 4 倍拡大して書き出し
- ファイル名: sprite_YYYYMMDD_HHMMSS.png（単体）または spritesheet_COLxROW_YYYYMMDD_HHMMSS.png

## 3. プレビュー
- p5.js キャンバスを使用し、登録スプライトを拡大表示
- チェッカーボード背景あり
- 情報欄: 登録数、計算上のシートサイズ、列×行情報を表示

## 4. メッセージ表示
- 追加成功、削除成功、出力開始/完了、エラーなどは日本語テキストをエラー欄に表示
- 表示色: デフォルトのテキスト色（成功/情報）と赤色（エラー）
- 表示時間: 自動非表示なし（次のメッセージで上書き）
- ステータスメッセージ用のカラー区別やアイコン表示、タイマー制御は **未実装**

## 5. 除外・未実装項目
- ドラッグ＆ドロップによる並び替え
- サムネイル選択状態のハイライト
- PNG 出力へのレイアウト設定反映
- 警告アイコン、色分け、表示時間制御などの高度なメッセージ UI
- キーボードショートカット、Undo/Redo 等の操作補助
- 入力文字数上限チェック（10,000 文字等）
- 入力サニタイズや Drag and Drop API 等の高度なブラウザ機能

## 6. 使用技術
- JavaScript / p5.js によるキャンバス描画
- DOM API を用いた UI 更新
- Canvas / Blob / URL.createObjectURL を利用した PNG 出力

## 7. 想定ファイル構成
- index.html: UI レイアウトと p5.js 読み込み
- style.css: ヒーローカード風のレイアウトスタイル、フォント設定など
- sketch.js: p5.js セットアップ、バリデーション、スプライト管理、PNG 出力処理

## 8. メンテナンス指針
- 入力バリデーション・スプライト管理・出力処理をモジュール化しており、各機能を個別に改善可能
- 今後、並び替えやメッセージ UI の拡張を行う場合はドキュメントの該当項目を追補すること
